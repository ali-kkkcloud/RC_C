<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Employee Dashboard - View your tasks, attendance, training progress and more">
    <meta name="robots" content="noindex, nofollow">
    <title>Employee Dashboard - Employee Portal</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ‘¤</text></svg>">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/mobile.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="employee-dashboard">
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-left">
            <button class="sidebar-toggle" onclick="toggleSidebar()" aria-label="Toggle sidebar">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
                <i class="fas fa-user"></i>
                <span>Employee Portal</span>
            </div>
        </div>
        
        <div class="header-center">
            <div class="current-time">
                <span id="currentTime">--:--:--</span>
                <small id="currentDate">--</small>
            </div>
        </div>
        
        <div class="header-right">
            <button class="header-btn notification-btn" onclick="toggleNotifications()" aria-label="Notifications">
                <i class="fas fa-bell"></i>
                <span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
            </button>
            
            <div class="user-menu">
                <button class="user-avatar" onclick="toggleUserMenu()" aria-label="User menu" aria-expanded="false">
                    <span class="user-avatar-text">JD</span>
                </button>
                <span class="user-name">John Doe</span>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <nav class="sidebar-nav" role="navigation" aria-label="Employee navigation">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="employee-dashboard.html" class="nav-link active" aria-current="page">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="attendance.html" class="nav-link">
                        <i class="fas fa-calendar-check"></i>
                        <span>Attendance</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="tasks.html" class="nav-link">
                        <i class="fas fa-tasks"></i>
                        <span>My Tasks</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="training.html" class="nav-link">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Training</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#schedule" class="nav-link" onclick="showSchedule()">
                        <i class="fas fa-calendar"></i>
                        <span>Schedule</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#profile" class="nav-link" onclick="showProfile()">
                        <i class="fas fa-user-circle"></i>
                        <span>My Profile</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-content">
                <h1>Welcome back, <span class="user-name-display">John</span>!</h1>
                <p>Here's what's happening with your work today.</p>
            </div>
            <div class="welcome-actions">
                <button class="btn btn-primary" onclick="quickCheckIn()">
                    <i class="fas fa-clock"></i>
                    Quick Check-in
                </button>
            </div>
        </section>

        <!-- Quick Stats -->
        <div class="dashboard-grid">
            <!-- Attendance Card -->
            <div class="dashboard-card attendance-card">
                <div class="card-header">
                    <h3>Today's Attendance</h3>
                    <div class="attendance-status">
                        <span id="attendanceStatus" class="badge badge-danger">Off Shift</span>
                    </div>
                </div>
                <div class="card-content">
                    <div class="attendance-info">
                        <div class="time-info">
                            <div class="time-item">
                                <label>Check In:</label>
                                <span id="checkInTime">--:--</span>
                            </div>
                            <div class="time-item">
                                <label>Check Out:</label>
                                <span id="checkOutTime">--:--</span>
                            </div>
                        </div>
                        <div class="hours-info">
                            <div class="hours-item">
                                <label>Total Hours:</label>
                                <span id="totalHours">0h 0m</span>
                            </div>
                        </div>
                    </div>
                    <div class="attendance-actions">
                        <button id="checkInBtn" class="btn btn-success" onclick="handleCheckIn()">
                            <i class="fas fa-sign-in-alt"></i>
                            Check In
                        </button>
                        <button id="checkOutBtn" class="btn btn-danger" onclick="handleCheckOut()" disabled>
                            <i class="fas fa-sign-out-alt"></i>
                            Check Out
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tasks Card -->
            <div class="dashboard-card tasks-card">
                <div class="card-header">
                    <h3>My Tasks</h3>
                    <a href="tasks.html" class="card-link">View All</a>
                </div>
                <div class="card-content">
                    <div class="task-stats">
                        <div class="task-stat">
                            <div class="stat-number" id="totalTasks">5</div>
                            <div class="stat-label">Total</div>
                        </div>
                        <div class="task-stat">
                            <div class="stat-number" id="pendingTasks">3</div>
                            <div class="stat-label">Pending</div>
                        </div>
                        <div class="task-stat">
                            <div class="stat-number" id="completedTasks">2</div>
                            <div class="stat-label">Completed</div>
                        </div>
                    </div>
                    <div class="recent-tasks" id="recentTasks">
                        <div class="task-item">
                            <div class="task-content">
                                <h5>Review Documentation</h5>
                                <span class="task-due">Due: Tomorrow</span>
                            </div>
                            <span class="task-priority high">High</span>
                        </div>
                        <div class="task-item">
                            <div class="task-content">
                                <h5>Team Meeting Prep</h5>
                                <span class="task-due">Due: Today</span>
                            </div>
                            <span class="task-priority medium">Medium</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Training Card -->
            <div class="dashboard-card training-card">
                <div class="card-header">
                    <h3>Training Progress</h3>
                    <a href="training.html" class="card-link">View Courses</a>
                </div>
                <div class="card-content">
                    <div class="current-course">
                        <div class="course-info">
                            <h4 id="currentCourseName">JavaScript Fundamentals</h4>
                            <p>Learn the basics of JavaScript programming</p>
                        </div>
                        <div class="course-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 65%" id="courseProgress"></div>
                            </div>
                            <span class="progress-text" id="progressText">65% Complete</span>
                        </div>
                    </div>
                    <div class="training-actions">
                        <button class="btn btn-primary" onclick="continueLearning()">
                            <i class="fas fa-play"></i>
                            Continue Learning
                        </button>
                    </div>
                </div>
            </div>

            <!-- Schedule Card -->
            <div class="dashboard-card schedule-card">
                <div class="card-header">
                    <h3>Today's Schedule</h3>
                    <div class="schedule-date" id="scheduleDate">--</div>
                </div>
                <div class="card-content">
                    <div class="schedule-list" id="scheduleList">
                        <div class="schedule-item">
                            <div class="schedule-time">
                                <span class="badge badge-info">09:00-10:30</span>
                            </div>
                            <div class="schedule-content">
                                <strong>Team Standup</strong>
                                <p>Conference Room A</p>
                            </div>
                        </div>
                        <div class="schedule-item">
                            <div class="schedule-time">
                                <span class="badge badge-success">11:00-12:30</span>
                            </div>
                            <div class="schedule-content">
                                <strong>Client Call</strong>
                                <p>Video Conference</p>
                            </div>
                        </div>
                        <div class="schedule-item">
                            <div class="schedule-time">
                                <span class="badge badge-warning">13:00-17:00</span>
                            </div>
                            <div class="schedule-content">
                                <strong>Project Work</strong>
                                <p>Development Tasks</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Card -->
            <div class="dashboard-card performance-card">
                <div class="card-header">
                    <h3>Performance Overview</h3>
                    <div class="performance-score">
                        <span id="performanceScore">85%</span>
                    </div>
                </div>
                <div class="card-content">
                    <div class="performance-metrics">
                        <div class="metric-item">
                            <div class="metric-label">Attendance Rate</div>
                            <div class="metric-value" id="attendanceRate">92%</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Task Completion</div>
                            <div class="metric-value" id="taskCompletion">88%</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Training Hours</div>
                            <div class="metric-value" id="trainingHours">24h</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions Card -->
            <div class="dashboard-card actions-card">
                <div class="card-header">
                    <h3>Quick Actions</h3>
                </div>
                <div class="card-content">
                    <div class="action-buttons">
                        <button class="action-btn" onclick="requestLeave()">
                            <i class="fas fa-calendar-times"></i>
                            <span>Request Leave</span>
                        </button>
                        <button class="action-btn" onclick="submitTimesheet()">
                            <i class="fas fa-clock"></i>
                            <span>Submit Timesheet</span>
                        </button>
                        <button class="action-btn" onclick="reportIssue()">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Report Issue</span>
                        </button>
                        <button class="action-btn" onclick="viewPaystub()">
                            <i class="fas fa-file-invoice-dollar"></i>
                            <span>View Paystub</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Notifications -->
        <section class="notifications-section">
            <div class="section-header">
                <h2>Recent Notifications</h2>
                <button class="btn btn-outline" onclick="viewAllNotifications()">View All</button>
            </div>
            <div class="notifications-list" id="notificationsList">
                <div class="notification-item">
                    <div class="notification-icon info">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="notification-content">
                        <h4>System Maintenance</h4>
                        <p>Scheduled maintenance this weekend from 2-4 AM</p>
                        <small>2 hours ago</small>
                    </div>
                </div>
                
                <div class="notification-item">
                    <div class="notification-icon success">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="notification-content">
                        <h4>Training Completed</h4>
                        <p>You've successfully completed "Safety Training"</p>
                        <small>1 day ago</small>
                    </div>
                </div>
                
                <div class="notification-item">
                    <div class="notification-icon warning">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="notification-content">
                        <h4>Task Deadline Reminder</h4>
                        <p>Don't forget: "Project Review" is due tomorrow</p>
                        <small>2 days ago</small>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- User Menu Dropdown -->
    <div id="userMenuDropdown" class="dropdown-menu" style="display: none;">
        <a href="#" onclick="showProfile()">
            <i class="fas fa-user"></i>
            My Profile
        </a>
        <a href="#" onclick="showSettings()">
            <i class="fas fa-cog"></i>
            Settings
        </a>
        <a href="#" onclick="showHelp()">
            <i class="fas fa-question-circle"></i>
            Help & Support
        </a>
        <hr>
        <a href="#" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>
            Logout
        </a>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal-overlay" style="display: none;" role="dialog" aria-labelledby="profile-title" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="profile-title">My Profile</h3>
                <button class="modal-close" onclick="closeModal('profileModal')" aria-label="Close profile dialog">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="profile-content">
                    <div class="profile-avatar">
                        <div class="avatar-circle">
                            <span class="avatar-text">JD</span>
                        </div>
                        <button class="btn btn-outline btn-sm">Change Photo</button>
                    </div>
                    <div class="profile-info">
                        <div class="info-group">
                            <label>Full Name:</label>
                            <span id="profileName">John Doe</span>
                        </div>
                        <div class="info-group">
                            <label>Email:</label>
                            <span id="profileEmail">john@company.com</span>
                        </div>
                        <div class="info-group">
                            <label>Department:</label>
                            <span id="profileDepartment">IT Department</span>
                        </div>
                        <div class="info-group">
                            <label>Employee ID:</label>
                            <span id="profileId">EMP001</span>
                        </div>
                        <div class="info-group">
                            <label>Hire Date:</label>
                            <span id="profileHireDate">January 15, 2023</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('profileModal')">Close</button>
                <button class="btn btn-primary" onclick="editProfile()">Edit Profile</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/attendance.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/training.js"></script>
    <script src="js/notifications.js"></script>
    
    <script>
        // Initialize employee dashboard
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Check authentication
                await checkAuth();
                
                // Initialize dashboard
                initializeEmployeeDashboard();
                
                // Start time updates
                updateCurrentTime();
                setInterval(updateCurrentTime, 1000);
                
                // Load dashboard data
                await loadDashboardData();
                
            } catch (error) {
                console.error('Employee dashboard initialization error:', error);
                showNotification('Failed to initialize dashboard', 'error');
            }
        });

        function initializeEmployeeDashboard() {
            try {
                const userData = JSON.parse(localStorage.getItem('currentUser') || '{}');
                
                // Update user display
                const userNameElements = document.querySelectorAll('.user-name');
                const userNameDisplayElements = document.querySelectorAll('.user-name-display');
                const userAvatarElements = document.querySelectorAll('.user-avatar-text, .avatar-text');
                
                userNameElements.forEach(element => {
                    element.textContent = userData.name || 'User';
                });
                
                userNameDisplayElements.forEach(element => {
                    element.textContent = userData.name ? userData.name.split(' ')[0] : 'User';
                });
                
                userAvatarElements.forEach(element => {
                    element.textContent = StringUtils.getInitials(userData.name || 'User');
                });
                
                // Update profile modal
                updateProfileModal(userData);
                
                // Set current date
                const currentDate = document.getElementById('currentDate');
                const scheduleDate = document.getElementById('scheduleDate');
                const today = new Date().toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                if (currentDate) currentDate.textContent = today;
                if (scheduleDate) scheduleDate.textContent = today;
                
            } catch (error) {
                console.error('Initialize employee dashboard error:', error);
            }
        }

        function updateCurrentTime() {
            try {
                const now = new Date();
                const timeElement = document.getElementById('currentTime');
                
                if (timeElement) {
                    timeElement.textContent = now.toLocaleTimeString('en-US', {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: true
                    });
                }
            } catch (error) {
                console.error('Update current time error:', error);
            }
        }

        async function loadDashboardData() {
            try {
                // Load attendance data
                if (window.attendanceManager) {
                    await window.attendanceManager.loadTodayAttendance();
                }
                
                // Load task data
                if (window.taskManager) {
                    await window.taskManager.loadTasks();
                    updateTaskDisplay();
                }
                
                // Load training data
                if (window.trainingManager) {
                    await window.trainingManager.loadUserProgress();
                    updateTrainingDisplay();
                }
                
            } catch (error) {
                console.error('Load dashboard data error:', error);
            }
        }

        function updateTaskDisplay() {
            try {
                if (!window.taskManager || !window.taskManager.tasks) return;
                
                const tasks = window.taskManager.tasks;
                const totalTasks = tasks.length;
                const pendingTasks = tasks.filter(t => t.status === 'pending').length;
                const completedTasks = tasks.filter(t => t.status === 'completed').length;
                
                // Update task stats
                const totalElement = document.getElementById('totalTasks');
                const pendingElement = document.getElementById('pendingTasks');
                const completedElement = document.getElementById('completedTasks');
                
                if (totalElement) totalElement.textContent = totalTasks;
                if (pendingElement) pendingElement.textContent = pendingTasks;
                if (completedElement) completedElement.textContent = completedTasks;
                
                // Update recent tasks
                const recentTasksElement = document.getElementById('recentTasks');
                if (recentTasksElement && tasks.length > 0) {
                    const recentTasks = tasks.slice(0, 3);
                    recentTasksElement.innerHTML = recentTasks.map(task => `
                        <div class="task-item">
                            <div class="task-content">
                                <h5>${StringUtils.escapeHtml(task.title)}</h5>
                                <span class="task-due">Due: ${DateTimeUtils.formatDate(task.due_date, 'relative')}</span>
                            </div>
                            <span class="task-priority ${task.priority}">${StringUtils.capitalize(task.priority)}</span>
                        </div>
                    `).join('');
                }
                
            } catch (error) {
                console.error('Update task display error:', error);
            }
        }

        function updateTrainingDisplay() {
            try {
                if (!window.trainingManager) return;
                
                // Find current course
                const inProgressCourses = Object.entries(window.trainingManager.userProgress)
                    .filter(([courseId, progress]) => progress.status === 'in_progress');
                
                if (inProgressCourses.length > 0) {
                    const [courseId, progress] = inProgressCourses[0];
                    const course = window.trainingManager.courses[courseId];
                    
                    if (course) {
                        const courseNameElement = document.getElementById('currentCourseName');
                        const progressElement = document.getElementById('courseProgress');
                        const progressTextElement = document.getElementById('progressText');
                        
                        if (courseNameElement) courseNameElement.textContent = course.title;
                        if (progressElement) progressElement.style.width = `${progress.progress_percentage || 0}%`;
                        if (progressTextElement) progressTextElement.textContent = `${progress.progress_percentage || 0}% Complete`;
                    }
                }
                
            } catch (error) {
                console.error('Update training display error:', error);
            }
        }

        function updateProfileModal(userData) {
            try {
                const profileElements = {
                    'profileName': userData.name,
                    'profileEmail': userData.email,
                    'profileDepartment': userData.department,
                    'profileId': userData.id,
                    'profileHireDate': userData.hire_date ? DateTimeUtils.formatDate(userData.hire_date, 'long') : 'N/A'
                };

                Object.entries(profileElements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element && value) {
                        element.textContent = value;
                    }
                });
            } catch (error) {
                console.error('Update profile modal error:', error);
            }
        }

        // Quick action functions
        function quickCheckIn() {
            if (window.attendanceManager && typeof window.attendanceManager.handleCheckIn === 'function') {
                window.attendanceManager.handleCheckIn();
            } else {
                window.location.href = 'attendance.html';
            }
        }

        function handleCheckIn() {
            if (window.attendanceManager && typeof window.attendanceManager.handleCheckIn === 'function') {
                window.attendanceManager.handleCheckIn();
            } else {
                showNotification('Check-in functionality not available', 'error');
            }
        }

        function handleCheckOut() {
            if (window.attendanceManager && typeof window.attendanceManager.handleCheckOut === 'function') {
                window.attendanceManager.handleCheckOut();
            } else {
                showNotification('Check-out functionality not available', 'error');
            }
        }

        function continueLearning() {
            window.location.href = 'training.html';
        }

        function requestLeave() {
            showNotification('Leave request feature coming soon', 'info');
        }

        function submitTimesheet() {
            showNotification('Timesheet feature coming soon', 'info');
        }

        function reportIssue() {
            showNotification('Issue reporting feature coming soon', 'info');
        }

        function viewPaystub() {
            showNotification('Paystub feature coming soon', 'info');
        }

        function viewAllNotifications() {
            if (window.notificationManager && typeof window.notificationManager.showNotificationCenter === 'function') {
                window.notificationManager.showNotificationCenter();
            } else {
                showNotification('Notification center coming soon', 'info');
            }
        }

        // Navigation functions
        function toggleSidebar() {
            try {
                const sidebar = document.getElementById('sidebar');
                if (sidebar) {
                    sidebar.classList.toggle('collapsed');
                }
            } catch (error) {
                console.error('Toggle sidebar error:', error);
            }
        }

        function toggleUserMenu() {
            try {
                const dropdown = document.getElementById('userMenuDropdown');
                const button = document.querySelector('.user-avatar');
                
                if (dropdown) {
                    const isVisible = dropdown.style.display !== 'none';
                    dropdown.style.display = isVisible ? 'none' : 'block';
                    
                    if (button) {
                        button.setAttribute('aria-expanded', !isVisible);
                    }
                }
            } catch (error) {
                console.error('Toggle user menu error:', error);
            }
        }

        function showSchedule() {
            showNotification('Schedule management feature coming soon', 'info');
        }

        function showProfile() {
            try {
                const modal = document.getElementById('profileModal');
                if (modal) {
                    modal.style.display = 'flex';
                }
            } catch (error) {
                console.error('Show profile error:', error);
            }
        }

        function showSettings() {
            window.location.href = 'settings.html';
        }

        function showHelp() {
            const helpContent = `
                <div class="help-content">
                    <h4>Employee Dashboard Help</h4>
                    <div class="help-section">
                        <h5>Getting Started</h5>
                        <p>Use the sidebar to navigate between different sections of your employee portal.</p>
                    </div>
                    <div class="help-section">
                        <h5>Attendance</h5>
                        <p>Check in and out using the attendance card or visit the dedicated attendance page for detailed tracking.</p>
                    </div>
                    <div class="help-section">
                        <h5>Tasks</h5>
                        <p>View and manage your assigned tasks. Click on any task to see details and update progress.</p>
                    </div>
                    <div class="help-section">
                        <h5>Training</h5>
                        <p>Access your training courses and track your learning progress.</p>
                    </div>
                    <div class="help-section">
                        <h5>Support</h5>
                        <p>If you need help, contact your supervisor or IT support team.</p>
                    </div>
                </div>
            `;
            
            if (window.UIUtils && typeof window.UIUtils.showModal === 'function') {
                window.UIUtils.showModal(helpContent, 'Help & Support');
            } else {
                showNotification('Help documentation available in user manual', 'info');
            }
        }

        function closeModal(modalId) {
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'none';
                }
            } catch (error) {
                console.error('Close modal error:', error);
            }
        }

        function editProfile() {
            showNotification('Profile editing feature coming soon', 'info');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            try {
                const userMenu = document.getElementById('userMenuDropdown');
                const userButton = document.querySelector('.user-avatar');
                
                if (userMenu && userButton && 
                    !userButton.contains(event.target) && 
                    !userMenu.contains(event.target)) {
                    userMenu.style.display = 'none';
                    userButton.setAttribute('aria-expanded', 'false');
                }
            } catch (error) {
                console.error('Click outside handler error:', error);
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', function(event) {
            try {
                if (event.key === 'Escape') {
                    // Close any open modals or dropdowns
                    const modals = document.querySelectorAll('.modal-overlay');
                    modals.forEach(modal => {
                        modal.style.display = 'none';
                    });
                    
                    const userMenu = document.getElementById('userMenuDropdown');
                    if (userMenu) {
                        userMenu.style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('Keyboard navigation error:', error);
            }
        });

        // Refresh dashboard data periodically
        setInterval(async () => {
            try {
                await loadDashboardData();
            } catch (error) {
                console.error('Periodic data refresh error:', error);
            }
        }, 300000); // Every 5 minutes
    </script>
</body>
</html>
